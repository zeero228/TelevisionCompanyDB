
-- ??????????? ???? ?? ????????????? ????????? ?? ???????????

-- ??????? 1: ??????? ?? ????????????? ????????? (????????)
SELECT
    s.ServiceName,
    COUNT(o.OrderID) AS TotalOrders,
    SUM(o.TotalAmount) AS TotalRevenue
FROM
    Services s
LEFT JOIN
    Orders o ON s.ServiceID = o.ServiceID
GROUP BY
    s.ServiceName
ORDER BY
    TotalRevenue DESC;

-- ??????? 2: ??????? ?? ????????? ?? ?????????? ????????? ????? ??????????? (?????? ?? ???????? ???, ?????????) ?? ??????? ??????
SELECT
    m.Category,
    COUNT(mo.MovieID) AS TotalMovies,
    SUM(mo.Price) AS TotalMovieRevenue
FROM
    Movies m
LEFT JOIN
    MovieOrders mo ON m.MovieID = mo.MovieID

GROUP BY
    m.Category
ORDER BY
    TotalMovieRevenue DESC;

-- ??????? 3: ???????? ??????? ?????? ?? ???????? ???? ??????????? (??? ???????? ?? ?????????)
SELECT SUM(Price) AS TotalMovieRevenue FROM MovieOrders;

